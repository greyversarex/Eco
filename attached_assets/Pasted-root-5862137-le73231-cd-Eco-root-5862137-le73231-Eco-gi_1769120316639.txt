root@5862137-le73231:~# cd ~/Eco
root@5862137-le73231:~/Eco# git pull origin main
remote: Enumerating objects: 193, done.
remote: Counting objects: 100% (193/193), done.
remote: Compressing objects: 100% (52/52), done.
remote: Total 175 (delta 133), reused 165 (delta 123), pack-reused 0 (from 0)
Receiving objects: 100% (175/175), 931.18 KiB | 5.01 MiB/s, done.
Resolving deltas: 100% (133/133), completed with 16 local objects.
From https://github.com/greyversarex/Eco
 * branch            main       -> FETCH_HEAD
   4f67917..ec99b60  main       -> origin/main
Updating 4f67917..ec99b60
Fast-forward
 .replit                                       |   2 +-
 attached_assets/image_1769110991191.png       | Bin 0 -> 35964 bytes
 attached_assets/image_1769111142148.png       | Bin 0 -> 31598 bytes
 attached_assets/image_1769111687167.png       | Bin 0 -> 246188 bytes
 attached_assets/image_1769112707995.png       | Bin 0 -> 19585 bytes
 attached_assets/image_1769112734752.png       | Bin 0 -> 55580 bytes
 attached_assets/image_1769112887721.png       | Bin 0 -> 27004 bytes
 attached_assets/image_1769112909848.png       | Bin 0 -> 186718 bytes
 attached_assets/image_1769113533874.png       | Bin 0 -> 29030 bytes
 attached_assets/image_1769113843184.png       | Bin 0 -> 116628 bytes
 attached_assets/image_1769113910481.png       | Bin 0 -> 28162 bytes
 attached_assets/image_1769114237774.png       | Bin 0 -> 13456 bytes
 attached_assets/image_1769114635908.png       | Bin 0 -> 18606 bytes
 attached_assets/image_1769114807364.png       | Bin 0 -> 20583 bytes
 attached_assets/image_1769114933127.png       | Bin 0 -> 21326 bytes
 attached_assets/image_1769115135583.png       | Bin 0 -> 31466 bytes
 attached_assets/image_1769115228169.png       | Bin 0 -> 37884 bytes
 attached_assets/image_1769118456309.png       | Bin 0 -> 30980 bytes
 client/src/components/ComposeMessageModal.tsx | 367 ++++++++++++++++++++++++++
 client/src/components/DocumentEditor.tsx      | 112 ++++++--
 client/src/components/DocumentStamp.tsx       | 110 ++++++++
 client/src/components/MessageListItem.tsx     |   2 +-
 client/src/pages/AssignmentsPage.tsx          | 192 +++++++++-----
 client/src/pages/ComposeMessage.tsx           |  18 +-
 client/src/pages/MessageView.tsx              | 193 ++++++++++----
 replit.md                                     |   1 +
 server/routes.ts                              |  69 ++++-
 server/seed.ts                                | 120 +++++----
 shared/schema.ts                              |   7 +
 29 files changed, 997 insertions(+), 196 deletions(-)
 create mode 100644 attached_assets/image_1769110991191.png
 create mode 100644 attached_assets/image_1769111142148.png
 create mode 100644 attached_assets/image_1769111687167.png
 create mode 100644 attached_assets/image_1769112707995.png
 create mode 100644 attached_assets/image_1769112734752.png
 create mode 100644 attached_assets/image_1769112887721.png
 create mode 100644 attached_assets/image_1769112909848.png
 create mode 100644 attached_assets/image_1769113533874.png
 create mode 100644 attached_assets/image_1769113843184.png
 create mode 100644 attached_assets/image_1769113910481.png
 create mode 100644 attached_assets/image_1769114237774.png
 create mode 100644 attached_assets/image_1769114635908.png
 create mode 100644 attached_assets/image_1769114807364.png
 create mode 100644 attached_assets/image_1769114933127.png
 create mode 100644 attached_assets/image_1769115135583.png
 create mode 100644 attached_assets/image_1769115228169.png
 create mode 100644 attached_assets/image_1769118456309.png
 create mode 100644 client/src/components/ComposeMessageModal.tsx
 create mode 100644 client/src/components/DocumentStamp.tsx
root@5862137-le73231:~/Eco# npm install

up to date, audited 1330 packages in 4s

238 packages are looking for funding
  run `npm fund` for details

14 vulnerabilities (1 low, 6 moderate, 7 high)

To address issues that do not require attention, run:
  npm audit fix

To address all issues possible (including breaking changes), run:
  npm audit fix --force

Some issues need review, and may require choosing
a different dependency.

Run `npm audit` for details.
root@5862137-le73231:~/Eco# npm run build

> rest-express@1.0.4 build
> vite build && esbuild server/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist

vite v5.4.21 building for production...
transforming (1) index.html[baseline-browser-mapping] The data in this module is over two months old.  To ensure accurate Baseline data, please update: `npm i baseline-browser-mapping@latest -D`
transforming (8) ../node_modules/workbox-window/build/workbox-window.prod.e
A PostCSS plugin did not pass the `from` option to `postcss.parse`. This may cause imported assets to be incorrectly transformed. If you've recently added a PostCSS plugin that raised this warning, please contact the package author to fix the issue.
✓ 2685 modules transformed.
../dist/public/manifest.webmanifest                          0.67 kB
../dist/public/index.html                                    5.92 kB │ gzip:   1.57 kB
../dist/public/assets/logo-optimized-B1zGXNhP.webp          16.56 kB
../dist/public/assets/eco-mobile-bg--UH-gaYc.webp           60.57 kB
../dist/public/assets/eco-bg-wide-CzQNBZHF.webp             75.40 kB
../dist/public/assets/eco-background-light-C9fnBE4q.webp   174.88 kB
../dist/public/assets/index-CZJfNOu5.css                   116.51 kB │ gzip:  17.91 kB
../dist/public/assets/index-BdQq_4o_.js                      0.06 kB │ gzip:   0.08 kB
../dist/public/assets/eco-background-light-DYjC9CQJ.js       0.07 kB │ gzip:   0.09 kB
../dist/public/assets/index-CQRFuDvl.js                      0.14 kB │ gzip:   0.14 kB
../dist/public/assets/index-Cou1ciIo.js                      0.23 kB │ gzip:   0.17 kB
../dist/public/assets/check-Bk5j2vBE.js                      0.29 kB │ gzip:   0.25 kB
../dist/public/assets/offline-indicator-LIxVYiWp.js          0.31 kB │ gzip:   0.26 kB
../dist/public/assets/plus-DNZAYuXn.js                       0.32 kB │ gzip:   0.26 kB
../dist/public/assets/arrow-left-Duq7ETza.js                 0.33 kB │ gzip:   0.27 kB
../dist/public/assets/check-check-R4bW6Zkz.js                0.35 kB │ gzip:   0.28 kB
../dist/public/assets/circle-check-big-DOhqm0HJ.js           0.36 kB │ gzip:   0.28 kB
../dist/public/assets/rotate-ccw-BrGCzsGm.js                 0.37 kB │ gzip:   0.29 kB
../dist/public/assets/circle-x-BI4rJ3m-.js                   0.38 kB │ gzip:   0.28 kB
../dist/public/assets/mail-DUHJ06iJ.js                       0.39 kB │ gzip:   0.30 kB
../dist/public/assets/paperclip-CJSbBeC5.js                  0.39 kB │ gzip:   0.30 kB
../dist/public/assets/circle-alert-CvugP5RJ.js               0.42 kB │ gzip:   0.29 kB
../dist/public/assets/eye-B7Lu3bZ_.js                        0.43 kB │ gzip:   0.31 kB
../dist/public/assets/upload-D4A09tSq.js                     0.43 kB │ gzip:   0.32 kB
../dist/public/assets/calendar-lYdaXnRx.js                   0.43 kB │ gzip:   0.31 kB
../dist/public/assets/download-wkSvVfmR.js                   0.43 kB │ gzip:   0.32 kB
../dist/public/assets/pencil-Cwta0Epc.js                     0.45 kB │ gzip:   0.33 kB
../dist/public/assets/pen-line-BwFnNC9m.js                   0.45 kB │ gzip:   0.33 kB
../dist/public/assets/users-XHx6F8Y_.js                      0.47 kB │ gzip:   0.33 kB
../dist/public/assets/square-pen-BBveZ3WI.js                 0.49 kB │ gzip:   0.34 kB
../dist/public/assets/refresh-cw-rrPgk-uW.js                 0.49 kB │ gzip:   0.33 kB
../dist/public/assets/textarea-BZKiL1cy.js                   0.50 kB │ gzip:   0.33 kB
../dist/public/assets/save-Ks1-Z_4j.js                       0.50 kB │ gzip:   0.33 kB
../dist/public/assets/file-text-D6AhPPuG.js                  0.50 kB │ gzip:   0.32 kB
../dist/public/assets/trash-2-1xHRqRJJ.js                    0.53 kB │ gzip:   0.35 kB
../dist/public/assets/grip-vertical-Bv6rfofG.js              0.54 kB │ gzip:   0.30 kB
../dist/public/assets/file-pen-fuf3m-dF.js                   0.54 kB │ gzip:   0.36 kB
../dist/public/assets/building-2-DySA1hRi.js                 0.61 kB │ gzip:   0.35 kB
../dist/public/assets/wifi-off-BeyJC4S4.js                   0.63 kB │ gzip:   0.38 kB
../dist/public/assets/not-found-CUeNHbdq.js                  0.63 kB │ gzip:   0.36 kB
../dist/public/assets/reply-rhgSw_Js.js                      0.67 kB │ gzip:   0.35 kB
../dist/public/assets/separator-UYsSRdD3.js                  0.67 kB │ gzip:   0.40 kB
../dist/public/assets/badge-DLBRhtZX.js                      0.73 kB │ gzip:   0.40 kB
../dist/public/assets/send-vtJ3QRXc.js                       0.76 kB │ gzip:   0.41 kB
../dist/public/assets/use-department-icon-CIdLTua_.js        0.79 kB │ gzip:   0.53 kB
../dist/public/assets/search-BaMUagvl.js                     0.83 kB │ gzip:   0.34 kB
../dist/public/assets/PageHeader-BoE5n_W7.js                 0.99 kB │ gzip:   0.46 kB
../dist/public/assets/shield-B5o7WNno.js                     1.13 kB │ gzip:   0.50 kB
../dist/public/assets/message-square-BSyb1ftG.js             1.26 kB │ gzip:   0.49 kB
../dist/public/assets/zoom-out-BaYxnFG_.js                   1.58 kB │ gzip:   0.52 kB
../dist/public/assets/Footer-BJ5_dKgE.js                     2.05 kB │ gzip:   0.96 kB
../dist/public/assets/checkbox-02bou_GT.js                   2.82 kB │ gzip:   1.39 kB
../dist/public/assets/popover-C3707r7y.js                    5.35 kB │ gzip:   1.94 kB
../dist/public/assets/workbox-window.prod.es5-B9K5rw8f.js    5.72 kB │ gzip:   2.35 kB
../dist/public/assets/DraftsPage-CZqR5aR_.js                 6.09 kB │ gzip:   2.17 kB
../dist/public/assets/MessageListItem-C5tk-CcA.js            6.14 kB │ gzip:   1.83 kB
../dist/public/assets/tabs-C-LsbaYW.js                       6.46 kB │ gzip:   2.56 kB
../dist/public/assets/AdminDepartments-BwHcNIqD.js           6.70 kB │ gzip:   2.18 kB
../dist/public/assets/AdminDocumentTypes-USENFgba.js         7.04 kB │ gzip:   2.61 kB
../dist/public/assets/dialog-BJ20teAY.js                     7.27 kB │ gzip:   2.68 kB
../dist/public/assets/MonitoringPage-C0e4IbEs.js             7.35 kB │ gzip:   2.45 kB
../dist/public/assets/TrashPage-DUi9nR1m.js                  8.01 kB │ gzip:   2.05 kB
../dist/public/assets/DepartmentMessages-BxLWm9jr.js         8.15 kB │ gzip:   2.77 kB
../dist/public/assets/Inbox-B86utwo5.js                      8.35 kB │ gzip:   3.43 kB
../dist/public/assets/AdminPeople-BWCllO11.js                9.76 kB │ gzip:   3.22 kB
../dist/public/assets/AnnouncementsPage-Dogs_KFA.js          9.98 kB │ gzip:   3.69 kB
../dist/public/assets/undo-aSLWmdrf.js                      10.41 kB │ gzip:   2.16 kB
../dist/public/assets/scroll-area-Cl9cAjkC.js               12.52 kB │ gzip:   3.94 kB
../dist/public/assets/AdminDepartmentMessages-cgGFkDVo.js   12.77 kB │ gzip:   3.50 kB
../dist/public/assets/PrivacyPolicy-BI2J4EOh.js             15.26 kB │ gzip:   4.12 kB
../dist/public/assets/AdminDocumentTemplates-BecmqTYG.js    15.39 kB │ gzip:   5.28 kB
../dist/public/assets/index-BAwPgWwc.js                     16.87 kB │ gzip:   6.36 kB
../dist/public/assets/format-BEMO4FpZ.js                    20.71 kB │ gzip:   5.85 kB
../dist/public/assets/select-D7qBN7wm.js                    21.21 kB │ gzip:   7.34 kB
../dist/public/assets/ComposeMessage-CM2K0IiJ.js            21.21 kB │ gzip:   6.62 kB
../dist/public/assets/DepartmentMain-DjOlDRFo.js            23.91 kB │ gzip:   6.14 kB
../dist/public/assets/MessageView-DPBBuOZN.js               31.22 kB │ gzip:   9.04 kB
../dist/public/assets/date-picker-CilWttRV.js               36.76 kB │ gzip:  11.85 kB
../dist/public/assets/AssignmentsPage-Cyj_2kKj.js           44.01 kB │ gzip:   9.69 kB
../dist/public/assets/AdminDashboard-BDbsp4vf.js           108.23 kB │ gzip:  33.08 kB
../dist/public/assets/index-WK-Du0oG.js                    310.32 kB │ gzip: 100.38 kB
../dist/public/assets/DocumentEditor--TrBPI74.js           458.37 kB │ gzip: 142.92 kB
../dist/public/assets/DepartmentCard-fBF3APfg.js           748.00 kB │ gzip: 132.54 kB

(!) Some chunks are larger than 500 kB after minification. Consider:
- Using dynamic import() to code-split the application
- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.
✓ built in 14.55s

PWA v1.1.0
Building public/sw.js service worker ("es" format)...
vite v5.4.21 building for production...
✓ 82 modules transformed.
../dist/public/sw.mjs  29.83 kB │ gzip: 9.82 kB
✓ built in 1.75s

PWA v1.1.0
mode      injectManifest
format:   es
precache  89 entries (2212.27 KiB)
files generated
  ../dist/public/sw.js

  dist/index.js  155.8kb

⚡ Done in 21ms
root@5862137-le73231:~/Eco# pm2 restart all
Use --update-env to update environment variables
[PM2] Applying action restartProcessId on app [all](ids: [ 0 ])
[PM2] [ecotajikistan](0) ✓
┌────┬────────────────────┬──────────┬──────┬───────────┬──────────┬──────────┐
│ id │ name               │ mode     │ ↺    │ status    │ cpu      │ memory   │
├────┼────────────────────┼──────────┼──────┼───────────┼──────────┼──────────┤
│ 0  │ ecotajikistan      │ fork     │ 21   │ online    │ 0%       │ 3.3mb    │
└────┴────────────────────┴──────────┴──────┴───────────┴──────────┴──────────┘
root@5862137-le73231:~/Eco# pm2 logs
[TAILING] Tailing last 15 lines for [all] processes (change the value with --lines option)
/root/.pm2/pm2.log last 15 lines:
PM2        | 2026-01-22T22:05:58: PM2 log: Stopping app:ecotajikistan id:0
PM2        | 2026-01-22T22:05:58: PM2 log: App [ecotajikistan:0] exited with code [0] via signal [SIGINT]
PM2        | 2026-01-22T22:05:58: PM2 log: pid=1108967 msg=process killed
PM2        | 2026-01-22T22:05:58: PM2 log: App [ecotajikistan:0] starting in -fork mode-
PM2        | 2026-01-22T22:05:58: PM2 log: App [ecotajikistan:0] online
PM2        | 2026-01-22T22:18:18: PM2 log: Stopping app:ecotajikistan id:0
PM2        | 2026-01-22T22:18:18: PM2 log: App [ecotajikistan:0] exited with code [0] via signal [SIGINT]
PM2        | 2026-01-22T22:18:19: PM2 log: pid=1109183 msg=process killed
PM2        | 2026-01-22T22:18:19: PM2 log: App [ecotajikistan:0] starting in -fork mode-
PM2        | 2026-01-22T22:18:19: PM2 log: App [ecotajikistan:0] online
PM2        | 2026-01-23T01:07:31: PM2 log: Stopping app:ecotajikistan id:0
PM2        | 2026-01-23T01:07:31: PM2 log: App [ecotajikistan:0] exited with code [0] via signal [SIGINT]
PM2        | 2026-01-23T01:07:31: PM2 log: pid=1109443 msg=process killed
PM2        | 2026-01-23T01:07:31: PM2 log: App [ecotajikistan:0] starting in -fork mode-
PM2        | 2026-01-23T01:07:31: PM2 log: App [ecotajikistan:0] online

/root/.pm2/logs/ecotajikistan-error.log last 15 lines:
0|ecotajik | Error: ENOENT: no such file or directory, stat '/root/Eco/dist/public/index.html'
0|ecotajik | [AUTH_MIDDLEWARE] Rejected: No session or user ID {
0|ecotajik |   hasDepartmentId: false,
0|ecotajik |   hasAdminId: false,
0|ecotajik |   sessionExists: true,
0|ecotajik |   path: '/api/counters',
0|ecotajik |   method: 'GET'
0|ecotajik | }
0|ecotajik | [AUTH_MIDDLEWARE] Rejected: No session or user ID {
0|ecotajik |   hasDepartmentId: false,
0|ecotajik |   hasAdminId: false,
0|ecotajik |   sessionExists: true,
0|ecotajik |   path: '/api/messages/unread/by-department',
0|ecotajik |   method: 'GET'
0|ecotajik | }

/root/.pm2/logs/ecotajikistan-out.log last 15 lines:
0|ecotajik | 3:14:12 AM [express] GET /api/messages/unread/by-department 200 in 3ms :: {"17":1}
0|ecotajik | 3:14:12 AM [express] GET /api/counters 500 in 7ms :: {"error":"column \"approval_status\" does not e…
0|ecotajik | 3:14:42 AM [express] GET /api/messages/unread/by-department 200 in 7ms :: {"17":1}
0|ecotajik | 3:14:42 AM [express] GET /api/counters 500 in 17ms :: {"error":"column \"approval_status\" does not …
0|ecotajik | 3:15:12 AM [express] GET /api/messages/unread/by-department 200 in 7ms :: {"17":1}
0|ecotajik | 3:15:12 AM [express] GET /api/counters 500 in 6ms :: {"error":"column \"approval_status\" does not e…
0|ecotajik | 3:15:42 AM [express] GET /api/messages/unread/by-department 200 in 4ms :: {"17":1}
0|ecotajik | 3:15:42 AM [express] GET /api/counters 500 in 22ms :: {"error":"column \"approval_status\" does not …
0|ecotajik | 3:15:51 AM [express] GET /api/document-types 200 in 6ms :: [{"id":1,"name":"Гузориш","description":n…
0|ecotajik | 3:15:51 AM [express] GET /api/assignments 500 in 17ms :: {"error":"column \"approval_status\" does n…
0|ecotajik | 3:15:55 AM [express] GET /api/messages/department/1 200 in 7ms :: {"received":[],"sent":[]}
0|ecotajik | 3:15:57 AM [express] GET /api/messages 200 in 5ms :: [{"id":333,"subject":"Гузориш","content":"Ба ра…
0|ecotajik | 3:16:00 AM [express] GET /api/messages/333 200 in 4ms :: {"id":333,"subject":"Гузориш","content":"Ба…
0|ecotajik | 3:16:00 AM [express] GET /api/messages/333/documents 200 in 5ms :: []
0|ecotajik | 3:16:00 AM [express] GET /api/messages/333/attachments 200 in 14ms :: [{"id":200,"filename":"супориш…
