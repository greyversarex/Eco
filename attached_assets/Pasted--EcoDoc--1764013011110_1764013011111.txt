–ü—Ä–∏–≤–µ—Ç! –¢—ã –ø—Ä–∏–Ω–∏–º–∞–µ—à—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –ø—Ä–æ–µ–∫—Ç–æ–º **EcoDoc** (–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–æ—Ä–æ—Ç–∞ –¢–∞–¥–∂–∏–∫–∏—Å—Ç–∞–Ω–∞).
–ü—Ä–æ–µ–∫—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å—Ç–∞–¥–∏–∏ **Production**. –û–Ω —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç –Ω–∞ VPS (Ubuntu + Nginx Reverse Proxy + SSL).

üö® **–í–ê–ñ–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û–ë –ê–†–•–ò–¢–ï–ö–¢–£–†–ï (–ß–ò–¢–ê–¢–¨ –í–ù–ò–ú–ê–¢–ï–õ–¨–ù–û):**

1.  **–°—Ç–µ–∫:** React (Vite) + Node.js (Express) + PostgreSQL (Drizzle ORM).
2.  **–ö–ª–∏–µ–Ω—Ç—ã:** Web, PWA (Android/iOS) –∏ –Ω–∞—Ç–∏–≤–Ω–æ–µ Android –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (—á–µ—Ä–µ–∑ TWA).
3.  **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ (`server/index.ts`):**
    *   –°–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞ Nginx, –ø–æ—ç—Ç–æ–º—É –≤–∫–ª—é—á–µ–Ω `app.set('trust proxy', 1)`.
    *   **CORS** –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ: `origin: true` –∏ `credentials: true`, —á—Ç–æ–±—ã –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã —Å –º–æ–±–∏–ª—å–Ω—ã—Ö WebView. **–ù–ï –ú–ï–ù–Ø–ô –≠–¢–û.**
    *   **Cookies** –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∫–∞–∫ `secure: true` –∏ `sameSite: 'lax'` (–∏–ª–∏ 'none'). –≠—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ PWA. **–ù–ï –°–ë–†–ê–°–´–í–ê–ô –≠–¢–ò –ù–ê–°–¢–†–û–ô–ö–ò.**

---

üéØ **–¢–ï–ö–£–©–ê–Ø –ó–ê–î–ê–ß–ê: –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –∏ –£–ª—É—á—à–µ–Ω–∏–µ Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**

–°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (`web-push`) —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç. –ù–æ —Ç–µ–∫—Å—Ç—ã –ø—Ä–∏—Ö–æ–¥—è—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º/–∞–Ω–≥–ª–∏–π—Å–∫–æ–º, –∏ –∏–∫–æ–Ω–∫–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è. –ù–∞–º –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∏—Ö –Ω–∞ –¢–∞–¥–∂–∏–∫—Å–∫–∏–π —è–∑—ã–∫ –∏ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–æ—Ç–∏–ø.

**–¢–≤–æ–∏ –¥–µ–π—Å—Ç–≤–∏—è:**

1.  **–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ñ–∞–π–ª `server/routes.ts`**.
2.  –ù–∞–π–¥–∏ –≤—Å–µ –º–µ—Å—Ç–∞, –≥–¥–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `sendPushNotification` (–æ–±—ã—á–Ω–æ –≤–Ω—É—Ç—Ä–∏ `app.post('/api/messages'...)`, `broadcast`, `assignments` –∏ `announcements`).
3.  **–ò–∑–º–µ–Ω–∏ payload (–¥–∞–Ω–Ω—ã–µ) —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:**

    *   **–Ø–∑—ã–∫ (–¢–∞–¥–∂–∏–∫—Å–∫–∏–π):**
        *   –í–º–µ—Å—Ç–æ "–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ" -> –ø–∏—à–∏ **"–ü–∞—ë–º–∏ –Ω–∞–≤"**.
        *   –í–º–µ—Å—Ç–æ "–û—Ç: [Name]" -> –ø–∏—à–∏ **"–ê–∑: [Name]"**.
        *   –í–º–µ—Å—Ç–æ "–ù–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ" -> –ø–∏—à–∏ **"–°—É–ø–æ—Ä–∏—à–∏ –Ω–∞–≤"**.
        *   –í–º–µ—Å—Ç–æ "–ù–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ" -> –ø–∏—à–∏ **"–≠—ä–ª–æ–Ω–∏ –Ω–∞–≤"**.

    *   **–í–Ω–µ—à–Ω–∏–π –≤–∏–¥ (–ò–∫–æ–Ω–∫–∏):**
        *   –í –æ–±—ä–µ–∫—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (options) –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–±–∞–≤—å –¥–≤–∞ –ø–æ–ª—è —Å –∞–±—Å–æ–ª—é—Ç–Ω–æ–π —Å—Å—ã–ª–∫–æ–π –Ω–∞ –ª–æ–≥–æ—Ç–∏–ø:
            ```javascript
            icon: 'https://ecodoc.cc/pwa-192.png',
            badge: 'https://ecodoc.cc/pwa-192.png'
            ```

**–ü—Ä–∏–º–µ—Ä —Ç–æ–≥–æ, –∫–∞–∫ –¥–æ–ª–∂–µ–Ω –≤—ã–≥–ª—è–¥–µ—Ç—å –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Å–ª–µ –ø—Ä–∞–≤–∫–∏:**
```javascript
await sendPushNotification(recipientId, 'department', {
  title: '–ü–∞—ë–º–∏ –Ω–∞–≤',
  body: `–ê–∑: ${senderName}`,
  icon: 'https://ecodoc.cc/pwa-192.png',
  badge: 'https://ecodoc.cc/pwa-192.png',
  url: '/department/inbox'
});
–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–Ω–µ—Å–∏ —ç—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∞–∫–∫—É—Ä–∞—Ç–Ω–æ, –Ω–µ –ª–æ–º–∞—è —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ª–æ–≥–∏–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤.
